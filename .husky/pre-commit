#!/bin/sh
branch_name=$(git symbolic-ref --short HEAD)

# Liste des branches ignorÃ©es (ex: main, develop)
if [ "$branch_name" = "master" ] || [ "$branch_name" = "develop" ]; then
  exit 0
fi

# Regex de validation : type/scope/description ou type/description
# Types autorisÃ©s : feat, fix, hotfix, docs, chore, style, refactor, test, cicd
valid_branch_regex="^(feat|fix|hotfix|docs|chore|style|refactor|test|cicd)\/[a-z0-9-]+(\/[a-z0-9-]+)?$"

if ! echo "$branch_name" | grep -Eq "$valid_branch_regex"; then
  echo "âŒ Erreur : Le nom de la branche '$branch_name' ne respecte pas la convention."
  echo "ğŸ‘‰ Format attendu : type/contexte/description-courte"
  echo "ğŸ‘‰ Exemple : feature/front/login-page"
  echo "ğŸš« Commit bloquÃ©. Renommez votre branche avec : git branch -m nouveau-nom"
  exit 1
fi
