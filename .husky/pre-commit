#!/bin/sh
branch_name=$(git symbolic-ref --short HEAD)

# Liste des branches ignorÃ©es (ex: main, develop)
if [ "$branch_name" = "main" ] || [ "$branch_name" = "develop" ]; then
  exit 0
fi

# Regex de validation : type/scope/description ou type/description
# Types autorisÃ©s : feature, fix, hotfix, docs, chore, refactor, test
valid_branch_regex="^(feature|fix|hotfix|docs|chore|refactor|test)\/[a-z0-9-]+(\/[a-z0-9-]+)?$"

if ! echo "$branch_name" | grep -Eq "$valid_branch_regex"; then
  echo "âŒ \033[31mErreur : Le nom de la branche '$branch_name' ne respecte pas la convention.\033[0m"
  echo "ğŸ‘‰ Format attendu : type/contexte/description-courte"
  echo "ğŸ‘‰ Exemple : feature/auth/login-page"
  echo "ğŸš« Commit bloquÃ©. Renommez votre branche avec : git branch -m nouveau-nom"
  exit 1
fi
